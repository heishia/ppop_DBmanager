"use strict";const e=require("electron"),t=require("path"),l=require("fs");let n=null;function s(){n=new e.BrowserWindow({width:1200,height:800,minWidth:800,minHeight:600,webPreferences:{preload:t.join(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1}}),process.env.VITE_DEV_SERVER_URL?(n.loadURL(process.env.VITE_DEV_SERVER_URL),n.webContents.openDevTools()):n.loadFile(t.join(__dirname,"../dist/index.html")),n.on("closed",()=>{n=null})}e.app.whenReady().then(()=>{s(),e.app.on("activate",()=>{e.BrowserWindow.getAllWindows().length===0&&s()})});e.app.on("window-all-closed",()=>{process.platform!=="darwin"&&e.app.quit()});e.ipcMain.handle("dialog:openFile",async()=>{const i=await e.dialog.showOpenDialog({properties:["openFile"],filters:[{name:"Spreadsheets",extensions:["csv","xlsx","xls"]}]});if(i.canceled||i.filePaths.length===0)return null;const o=i.filePaths[0],a=l.readFileSync(o);return{path:o,name:t.basename(o),buffer:a.toString("base64")}});
